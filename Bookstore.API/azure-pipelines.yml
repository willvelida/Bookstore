trigger:
  - main

variables:
  buildConfiguration: 'Release'
  vmImageName: 'vs2017-win2016'
  workingDirectory: '$(System.DefaultWorkingDirectory)/Bookstore.API'

stages:
  - stage: Build
    displayName: Build Stage
    

    jobs:
      - job: Build
        displayName: Build
        pool:
          vmImage: $(vmImageName)
        steps:
        - task: DotNetCoreCLI@2
          displayName: Restore
          inputs:
            command: 'restore'
            projects: '**/*.csproj'
        - task: DotNetCoreCLI@2
          displayName: Build
          inputs:
            command: 'build'
            projects: '**/*.csproj'
            arguments: --configuration $(buildConfiguration)

        - task: DotNetCoreCLI@2
          displayName: Test
          inputs:
            command: 'test'
            projects: '**/*Tests/*.csproj'
            workingDirectory: 'Bookstore.API.UnitTests'